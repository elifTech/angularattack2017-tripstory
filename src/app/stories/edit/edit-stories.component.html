<div class="edit-stories">

  <div class="main">
    <span class="image-container">
      <img src="{{coverPhoto}}" />
      </span>

      <span class="text-content">
      <span class="title">{{model.title}}</span>
      <span class="subheader">{{model.subheader}}</span>
    </span>
  </div>

  <div class="line"></div>
  <div *ngFor="let path of model.path; let i = index;" [ngClass]="{'path': path.pathType === 'path', 'point': path.pathType === 'poi'}">
    <div class="point-content" *ngIf="path.pathType === 'poi'">
      <div style="position: absolute; right: 12px; top: 12px; width: 16px; height: 16px; cursor: pointer" (click)="onEdit(path)">
        <md-icon style="color: #c2c2c2; font-size: 16px;">edit</md-icon>
      </div>
      <!--<span class="location">{{path.subheader}}</span>-->
      <span class="title" *ngIf="path.location && path.location.title">
        {{path.location.title}}
      </span>
      <span class="title not-setuped" *ngIf="!path.location || !path.location.title">
        Fancy new title
      </span>
      <div style="display: flex; flex-direction: row; justify-content: space-between; color: #3c474b">
        <div style="flex: 1; display: flex">
          <md-icon>keyboard</md-icon>
          <span style="padding-left: 8px">story</span>
        </div>
        <div style="flex: 1; display: flex">
          <md-icon>photo_camera</md-icon>
          <span style="padding-left: 8px">{{path.files.length}} photos</span>
        </div>
      </div>
    </div>
    <div *ngIf="path.pathType === 'path'">
      <a class="path-select">
        <md-icon *ngIf="path.travelType === 'driving'">directions_car</md-icon>
        <md-icon *ngIf="path.travelType === 'walking'">walking</md-icon>
        <md-icon *ngIf="path.travelType === 'ferry'">ferry</md-icon>
        <md-icon *ngIf="path.travelType === 'plain'">plain</md-icon>
      </a>
      <div class="path-photos">
        <div *ngFor="let file of path.files" class="path-photo-wrapper">
          <img src="{{file.path}}" width="72" height="56" />
          <span class="path-photo-title">{{file.title}}</span>
        </div>
      </div>
    </div>
  </div>
  <div class="new-point">
    <a class="upload-photos">
      <div class="icon-wrapper">
        <md-icon>photo_camera</md-icon>
      </div>
      <div class="icon-title">
        Add new point
      </div>
    </a>
    <div class="or">
      - or -
    </div>
    <a class="add-new-points">
      <div class="icon-wrapper">
        <md-icon>add</md-icon>
      </div>
      <div class="icon-title">
        Upload photos
      </div>
    </a>
  </div>

  <div class="endpoint">

    <span class="text-content">
      <span class="title">{{model.backTitle || 'Back'}}</span>
      <span class="subheader">{{model.backSubheader}}</span>
    </span>
  </div>
</div>

<div class="edit-stories-editable" *ngIf="editablePoint">
  <div class="modal">

    <h2>{{editablePoint.title}}</h2>

    <form #heroForm="ngForm" name="newForm" (ngSubmit)="onSubmit()">

      <div class="form-group">
        <md-input-container>

          <input mdInput placeholder="Story title" type="text" class="form-control" [(ngModel)]="editablePoint.title"
                 name="title" required>
          <md-hint>
            Interesting title of your story
          </md-hint>
        </md-input-container>
      </div>
      <div class="form-group">

        <div class="coordinates">
          Point coords: {{editablePoint.location.point.lat}}; {{editablePoint.location.point.lng}}
        </div>

        <md-input-container>

          <input mdInput placeholder="Point coordinates" [mdAutocomplete]="auto" [formControl]="pointControl" required>

          <md-hint>
            Enter address where your trip starts
            {{state}}
          </md-hint>
        </md-input-container>
        <md-autocomplete #auto="mdAutocomplete" [displayWith]="setPoint" md-item-text="item.formatted_address">
          <md-option *ngFor="let state of pointOptions | async" [value]="state">
            {{ state.formatted_address }}
          </md-option>
        </md-autocomplete>
      </div>

      <div class="image-block">
        <div class="img-container" *ngFor="let image of editablePoint.files">

          <img src="{{'http://localhost:4040' + '/' + image.path}}"  name="path" height="70" width="90">
          <a (click)="removeFile(image)">X</a>
        </div>
      </div>
      <input type="file" ng2FileSelect [uploader]="uploader" multiple/><br/>


      <div class="form-actions">
        <button type="submit" md-raised-button>Save</button>
      </div>
    </form>

  </div>
</div>
